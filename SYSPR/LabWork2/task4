%include "io64.inc"

section .text
global CMAIN
CMAIN:
    PRINT_STRING "file size(bytes): "
    GET_DEC 8, rax          ; используем 8 байт, т.к. размер может быть > 2³¹-1

    ; делим на 1024
    mov rbx, 1024
    mov rdx, 0
    div rbx                 ; eax = килобайты, edx = остаток в байтах

    PRINT_STRING "Size in kilobytes: "
    PRINT_DEC 8, rax

    ; можно вывести и остаток, если хочется точнее
    cmp rdx, 0
    je .without_remainder

    PRINT_STRING " + "
    PRINT_DEC 4, rdx
    PRINT_STRING " bytes"

.without_remainder:
    NEWLINE

    xor rax, rax
    ret
