-- 1. Подключаемся к базе данных BookShop
USE [BookShop]
GO

-- 5.1 Вставить новую книгу (только обязательные поля)
INSERT INTO [dbo].[Book] ([AuthorId], [Title], [Genre], [Price], [Weight], [PageCount])
VALUES (1, N'Новая книга Пушкина', N'проза', 500.00, 0.300, 200);
GO

-- 5.2 Удалить заказчиков без адреса
DELETE FROM [dbo].[Customer] 
WHERE [Address] IS NULL OR LTRIM(RTRIM([Address])) = '';
GO

-- 5.3 Изменить цену книг с названием «Сказки»
UPDATE [dbo].[Book] 
SET [Price] = [Price] - 100
WHERE [Title] LIKE N'%Сказки%';
GO

-- 5.4 Создать таблицу «Проза» с книгами этого жанра
IF OBJECT_ID('dbo.Проза', 'U') IS NOT NULL
    DROP TABLE [dbo].[Проза];

SELECT 
    [Title] AS [Наименование книги],
    [Price] AS [Цена],
    [Weight] AS [Масса],
    [ReleaseYear] AS [Год выпуска]
INTO [dbo].[Проза]
FROM [dbo].[Book]
WHERE [Genre] = N'проза';
GO

-- 5.5 Удалить из таблицы «Проза» книги дороже 1000 рублей
DELETE FROM [dbo].[Проза]
WHERE [Цена] > 1000;
GO
