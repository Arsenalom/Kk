USE [BookShop];
GO

-- 5.1 Получить все данные обо всех книгах
SELECT '5.1 - Все данные о книгах' AS [Задание];
SELECT * FROM [dbo].[Book];
GO

-- 5.2 Получить ФИО авторов в одном столбце
SELECT '5.2 - ФИО авторов' AS [Задание];
SELECT [Surname] + ' ' + [Name] AS [ФИО автора] FROM [dbo].[Author];
GO

-- 5.3 Получить уникальные страны авторов по алфавиту
SELECT '5.3 - Уникальные страны авторов' AS [Задание];
SELECT DISTINCT [Country] AS [Страна] 
FROM [dbo].[Author]
ORDER BY [Country] ASC;
GO

-- 5.4 Получить данные о книгах с 5% скидкой
SELECT '5.4 - Книги с 5% скидкой' AS [Задание];
SELECT 
    [BookId] AS [Идентификатор книги],
    [Title] AS [Название книги],
    ROUND([Price] * 0.95, 2) AS [Цена со скидкой 5%]
FROM [dbo].[Book]
ORDER BY [Цена со скидкой 5%] DESC, [Title] ASC;
GO

-- 5.5 Получить статистику по книгам
SELECT '5.5 - Общая статистика по книгам' AS [Задание];
SELECT 
    COUNT(*) AS [Количество книг],
    MIN([Price]) AS [Минимальная цена],
    MAX([Price]) AS [Максимальная цена],
    CAST(AVG([Price]) AS DECIMAL(10,2)) AS [Средняя цена]
FROM [dbo].[Book];
GO

-- 5.6 Получить статистику по жанрам
SELECT '5.6 - Статистика по жанрам' AS [Задание];
SELECT 
    [Genre] AS [Жанр],
    MAX([Price]) AS [Максимальная цена],
    MIN([Price]) AS [Минимальная цена],
    COUNT(*) AS [Количество книг]
FROM [dbo].[Book]
GROUP BY [Genre]
ORDER BY [Жанр];
GO
